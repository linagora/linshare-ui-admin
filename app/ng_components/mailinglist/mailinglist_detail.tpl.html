<div class="box box-primary">
  <div class="box-header">
    <h3 class="box-title">
      {{mail.identifier}}
    </h3>
    <div class="pull-right box-tools">
      <div class="btn-group">
        <button class="btn btn-primary pull-right" type="button"
                x-ng-click="cancel()">
          <span>
            <i class="fa fa-list"></i> 
            {{ 'MAILING_LISTS.BOX_FORM.BUTTON_LIST' | translate }}
          </span>
        </button>
      </div>
    </div>
  </div>
  <form class="form" name="mailForm" novalidate
      x-ls-form-submit="submit(mail)"
      x-ls-form-attempt>
    <fieldset>
      <div class="box-body">
        <!-- Description -->
        <div class="form-group">
          <label for="description">
            {{ 'MAILING_LISTS.BOX_FORM.LABEL_DESCRIPTION' | translate }}
          </label>
          <input type="text" id="description" name="description" class="form-control"
                 x-ng-model="mail.description">
        </div>
        <!-- Visibility -->
        <div class="form-group">
          <label for="isPublic">
            {{ 'MAILING_LISTS.BOX_FORM.LABEL_IS_PUBLIC' | translate }}
          </label>
          <div class="input-group col-sm-1">
            <span class="input-group-addon">
              <input id="isPublic" name="isPublic" type="checkbox"
                     x-ng-model="mail.public">
            </span>
            <span class="form-control">
              {{ mail.public ? 'MAILING_LISTS.LABEL_PUBLIC' : 'MAILING_LISTS.LABEL_PRIVATE' | translate }}
            </span>
          </div>
        </div>
        <!-- Owner -->
        <div class="form-group">
          <label for="owner">
            {{ 'MAILING_LISTS.BOX_FORM.LABEL_OWNER' | translate }}
          </label>
          <div class="controls">
            <span name="owner" class="form-control-static">
              {{mail.owner.firstName}}&nbsp;-&nbsp;{{mail.owner.lastName}}
            </span>
          </div>
        </div>
      </div>
      <div class="box-footer">
        <!-- Validation -->
        <div class="control-group">
          <div class="controls">
            <button id="delete" name="delete" type="button" class="btn btn-danger"
                    x-ng-click="remove()">
              {{ 'MAILING_LISTS.BOX_FORM.FORM_ACTIONS.BUTTON_DELETE' | translate }}
            </button>
            <button type="button" id="reset" name="reset" class="btn btn-warning"
                    x-ng-click="reset()">
              {{ 'MAILING_LISTS.BOX_FORM.FORM_ACTIONS.BUTTON_RESET' | translate }}
            </button>
            <button type="submit" id="submit" name="submit" class="btn btn-success">
              {{ 'MAILING_LISTS.BOX_FORM.FORM_ACTIONS.BUTTON_SUBMIT' | translate }}
            </button>
          </div>
        </div>
      </div>
    </fieldset>
  </form>
</div>

<!-- USER LIST -->

<script type="text/ng-template" id="user_representation">
  <a>
    <span bind-html-unsafe="match.model.firstName | typeaheadHighlight:query"></span>&nbsp;
    <span bind-html-unsafe="match.model.lastName | typeaheadHighlight:query"></span>&nbsp;&lt;
    <span bind-html-unsafe="match.model.mail | typeaheadHighlight:query"></span>&gt;
  </a>
</script>

<div class="box box-primary">
  <div class="box-header">
    <h3 class="box-title">
      {{ 'MAILING_LISTS.BOX_CONTACTS_LIST.TITLE' | translate }}
    </h3>
  </div>
  <div class="box-body">
    <form class="form-inline form-group"
        x-ls-form-submit="addContact(contactToAdd)"
        x-ls-form-attempt>
      <div class="form-group col-sm-4">
        <label class="sr-only" for="mail">
          {{ 'MAILING_LISTS.BOX_CONTACTS_LIST.PLACEHOLDER_EMAIL' | translate }}
        </label>
        <input type="text" class="form-control" id="mail" required
               placeholder="{{ 'MAILING_LISTS.BOX_CONTACTS_LIST.PLACEHOLDER_EMAIL' | translate }}"
               x-ng-model="autocompleteValue"
               x-typeahead-min-length="3"
               x-typeahead-wait-ms="30"
               x-typeahead-loading="searching"
               x-typeahead-on-select="fieldForm(autocompleteValue)"
               x-typeahead="u for u in autocompleteUsers($viewValue) | filter:$viewValue"
               x-typeahead-template-url="user_representation"/>
      </div>
      <div class="form-group col-sm-3">
        <label class="sr-only" for="firstName">
          {{ 'MAILING_LISTS.BOX_CONTACTS_LIST.PLACEHOLDER_FIRST_NAME' | translate }}
        </label>
        <input type="text" class="form-control" id="firstName"
               placeholder="{{ 'MAILING_LISTS.BOX_CONTACTS_LIST.PLACEHOLDER_FIRST_NAME' | translate }}"
               x-ng-model="contactToAdd.firstName"/>
      </div>
      <div class="form-group col-sm-3">
        <label class="sr-only" for="lastName">
          {{ 'MAILING_LISTS.BOX_CONTACTS_LIST.PLACEHOLDER_LAST_NAME' | translate }}
        </label>
        <input type="text" class="form-control" id="lastName"
               placeholder="{{'MAILING_LISTS.BOX_CONTACTS_LIST.PLACEHOLDER_LAST_NAME' | translate}}"
               x-ng-model="contactToAdd.lastName"/>
      </div>
      <button type="submit" class="btn btn-success">
        <i class="fa fa-plus"></i>&nbsp;
        {{ 'MAILING_LISTS.BOX_CONTACTS_LIST.BUTTON_ADD_CONTACT' | translate }}
      </button>
    </form>
    <div class="form-group">
      <div class="table-responsive">
        <table class="table"
               x-ng-table="tableParams">
          <tr x-ng-repeat="contact in $data">
            <td class="col-sm-4"
                data-title="'MAILING_LISTS.BOX_CONTACTS_LIST.TABLE.HEADER_EMAIL' | translate"
                sortable="'mail'">
              <span>
                {{contact.mail}}
              </span>
            </td>
            <td class="col-sm-3"
                data-title="'MAILING_LISTS.BOX_CONTACTS_LIST.TABLE.HEADER_FIRST_NAME' | translate"
                sortable="'firstName'">
              <span>
                {{contact.firstName}}
              </span>
            </td>
            <td class="col-sm-3"
                data-title="'MAILING_LISTS.BOX_CONTACTS_LIST.TABLE.HEADER_LAST_NAME' | translate"
                sortable="'lastName'">
              <span>
                {{contact.lastName}}
              </span>
            </td>
            <td class="col-sm-2"
                data-title="'MAILING_LISTS.BOX_CONTACTS_LIST.TABLE.HEADER_ACTIONS' | translate">
              <button class="btn btn-danger"
                      x-ng-show="confirm === undefined"
                      x-ng-click="confirm = $index">
                {{ 'MAILING_LISTS.BOX_CONTACTS_LIST.TABLE.BUTTON_DELETE_CONTACT' | translate }}
              </button>
              <button class="btn"
                      x-ng-show="confirm === $index"
                      x-ng-click="confirm = undefined">
                {{ 'MAILING_LISTS.BOX_CONTACTS_LIST.TABLE.BUTTON_DELETE_CONTACT_NO' | translate }}
              </button>
              <button class="btn btn-danger"
                      x-ng-show="confirm === $index"
                      x-ng-click="deleteContact(contact)">
                {{ 'MAILING_LISTS.BOX_CONTACTS_LIST.TABLE.BUTTON_DELETE_CONTACT_YES' | translate }}
              </button>
            </td>
          </tr>
        </table>
      </div>
    </div>
  </div>
</div>
